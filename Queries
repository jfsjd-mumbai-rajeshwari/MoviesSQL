--QUERIES

-- QUERY 1
1. List the titles of all movies directed by "Hitchcock".

SELECT MOVTITLE
FROM MOVIES
WHERE DIRID IN (SELECT DIRID
FROM DIRECTOR
WHERE DIRNAME='HITCHCOCK');


-- QUERY 2
2. Find the movie names where one or more actors acted in two or more movies.

SELECT MOVTITLE
FROM MOVIES M,MOVIECAST MV
WHERE M.MOVID=MV.MOVID AND ACTID IN (SELECT ACTID
FROM MOVIECAST GROUP BY ACTID
HAVING COUNT (ACTID)>1)
GROUP BY MOVTITLE
HAVING COUNT(*)>1;


-- QUERY 3
3. List all actors who acted in a movie before 2000 and also in a movie after 2015.

SELECT ACTNAME,MOVTITLE,MOVYEAR
FROM ACTOR A
JOIN MOVIECAST C
ON A.ACTID=C.ACTID
JOIN MOVIES M
ON C.MOVID=M.MOVID
WHERE M.MOVYEAR NOT BETWEEN 2000 AND 2015;

--(OR)

SELECT A.ACTNAME,C.MOVTITLE,C.MOVYEAR
FROM ACTOR A,MOVIECAST B,MOVIES C
WHERE A.ACTID=B.ACTID
AND B.MOVID=C.MOVID
AND C.MOVYEAR NOT BETWEEN 2000 AND 2005;


-- QUERY 4
4. Find the title of movies and number of stars for each movie that has at least one
rating and find the highest number of stars that movie received. Sort the result by
movie title.

SELECT MOVTITLE,MAX(REVSTARS)
FROM MOVIES
INNER JOIN RATING USING (MOVID)
GROUP BY MOVTITLE
HAVING MAX (REVSTARS)>0
ORDER BY MOVTITLE;


-- QUERY 5
5. Update rating of all movies directed by "Steven Spielberg" to 5.

UPDATE RATING
SET REVSTARS=5
WHERE MOVID IN (SELECT MOVID FROM MOVIES
WHERE DIRID IN (SELECT DIRID
FROM DIRECTOR
WHERE DIRNAME='STEVEN SPIELBERG'));

SELECT * FROM RATING;